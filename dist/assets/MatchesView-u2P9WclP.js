import{d as G,x as B,f as H,j as J,g as K,r as a,c as N,y as x,h as Q,M as S,k as c,o as d,a as r,b as m,e as v,p as b,q as O,F as k,l as w,z as L,t as W}from"./index-DHr_EMP0.js";import{_ as X}from"./MatchGraph.vue_vue_type_script_setup_true_lang-B3i6H2qG.js";import"./installCanvasRenderer-CQuuMhjR.js";const Y={class:"container py-1"},Z={class:"col-sm-3"},ee={class:"row"},te={class:"mt-3"},ae={class:"row mt-3"},ue=G({__name:"MatchesView",setup(le){B("$formatDate"),B("$deepCopy");const f=H(),n=J(),g=K(),p=a([]);a({});const h=a(1);a(0);const D=a(["name"]),C=a("");a(!1);const V=a(null),$=a(-1),M=a([]),T=a([]),o=a("Totales (incl. prórroga)"),s=a([]);a(null),a(null);const _=a(new Date);a(!1),N(()=>$.value===-1?"Crear match":"Editar match");const z=N(()=>f.state.matchesModule.new_odd);x(C,()=>{clearTimeout(V.value),V.value=setTimeout(()=>{h.value=1,i(h.value)},600)}),x(z,l=>{const{matchId:e,bettingOdds:u}=l;p.value.find(y=>y._id===e)},{deep:!0}),Q(()=>{var l,e;(l=n==null?void 0:n.query)!=null&&l.leagues&&(s.value=n.query.leagues),(e=n==null?void 0:n.query)!=null&&e.bet_name&&(o.value=n.query.bet_name),g.push({query:{leagues:s.value,bet_name:o.value}}),i()});async function i(l=1){let e={page:h.value||l,search:C.value,fieldsToSearch:D.value,sort:"createdAt",order:"desc",limit:15,dateFrom:_.value,dateTo:_.value,leagues:s.value,betName:o.value};await Promise.all([f.dispatch("matchesModule/list",e)]),p.value=f.state.matchesModule.matches,S.listLeagues(!0).then(u=>{M.value=u.data.payload}),S.listBetNames(!0,p.value.map(u=>u._id)).then(u=>{T.value=u.data.payload})}function F(){i()}function j(){window.open("/matches?leagues=all","_self")}function A(l){s.value.includes(l)?s.value=s.value.filter(e=>e!==l):s.value.push(l),s.value.length&&g.push({query:{leagues:s.value,bet_name:o.value}}),i()}function E(l){o.value&&g.push({query:{bet_name:o.value,leagues:s.value}}),o.value=l,i()}return(l,e)=>{const u=c("el-button"),y=c("el-option"),I=c("el-select"),R=c("el-date-picker"),U=c("el-tag"),P=c("el-divider");return d(),r("div",null,[m("div",Y,[v(u,{class:"my-2",type:"primary",onClick:j},{default:b(()=>e[4]||(e[4]=[O("Mostrar todas las ligas")])),_:1}),m("div",Z,[v(I,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value=t),placeholder:"Tipo de apuesta",onChange:e[1]||(e[1]=t=>E(t)),clearable:""},{default:b(()=>[(d(!0),r(k,null,w(T.value,(t,q)=>(d(),L(y,{key:q,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),m("div",ee,[v(R,{onChange:e[2]||(e[2]=t=>F()),modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),type:"date",placeholder:"Selecciona un día",size:"large"},null,8,["modelValue"])]),m("div",te,[(d(!0),r(k,null,w(M.value,t=>(d(),L(U,{key:t,class:"mx-1 leagues-selector mb-2",effect:"dark",type:s.value.includes(t)?"success":"info",round:"",onClick:q=>A(t)},{default:b(()=>[O(W(t),1)]),_:2},1032,["type","onClick"]))),128)),v(P)]),m("div",ae,[(d(!0),r(k,null,w(p.value,t=>(d(),r("div",{class:"col-sm-6",key:t._id},[v(X,{match:t,bettingOdds:t.odds},null,8,["match","bettingOdds"])]))),128))])])])}}});export{ue as default};
