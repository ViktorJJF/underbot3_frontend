import{d as b,r as o,f as ee,c as q,y as ae,h as le,R as V,k as p,o as u,a as h,b as e,e as d,p as H,F as x,l as F,u as Q,w as se,A as te,t as s,q as _,z as k,n as z,s as oe,C as ne,D as ue}from"./index-DHr_EMP0.js";import{s as L}from"./subDays-CGrVKdv9.js";const de={class:"container"},ie={class:"row my-3"},re={class:"col-sm-3"},ce={class:"col-sm-3"},me={class:"col-sm-3"},ve={class:"col-sm-3"},pe={class:"row"},he={class:"row"},fe={class:"col-sm-6"},ye={class:"match-ended"},we={class:"d-inline"},De={class:"table"},Ve={scope:"row"},_e=["href"],xe=b({__name:"SimulationView2",setup(ge){const E=o([]),C=o(new Date(L(new Date,1))),S=o(new Date(L(new Date,1))),$=o(new Date("2023-10-26")),g=o(null),M=o(!1),y=o(0),B=o(0),O=o(0),I=o(0),i=o([]);o({});const r=o({wins:0,losses:0,winrate:0}),v=o({wins:0,losses:0,winrate:0}),P=o(0),c=o({fromQuarter:[!0,"c4","Evaluar desde","text"],untilQuarter:[!0,"c4","Evaluar hasta","text"],fromTime:[!0,12*60*1e3,"Desde (milisegundos) (Faltando 2 min para acabar c3) ","number"],untilTime:[!0,5*60*1e3,"Hasta (milisegundos) (Antes de llegar al minuto 5 de c4)","number"],minUnderPercent:[!1,80,"Mínimo porcentaje de Under","number"],hasUnderBeatOver:[!1,!1,"Under supera o iguala over","boolean"],minimalScoreDifference:[!1,8,"Mínima diferencia de score (pendiente) (NEW)","number"],minimalUpsDownsDifference:[!0,.1,"Mínima diferencia de Ups/Downs %","number"],hasInvertedCones:[!0,!0,"Evaluar gráfica en forma de montañas","boolean"],minimalDifferenceToNextBet:[!0,2,"Mínima diferencia para apostar de nuevo en mismo match","number"],moneyBet:[!0,333,"Dinero a apostar (Primera apuesta cebo)","number"],moneyNextBet:[!0,533,"Dinero a apostar (Siguientes apuestas)","number"],ignoreFirstBet:[!1,!0,"Ignorar primera apuesta","boolean"]}),N=ee(),R=q(()=>i.value),w=q(()=>c.value.ignoreFirstBet[0]&&c.value.ignoreFirstBet[1]?i.value.filter(t=>!t.isFirstBet):R.value);ae(c,()=>{clearTimeout(I.value),I.value=setTimeout(()=>{},500)},{deep:!0}),le(async()=>{await D()});async function D(){M.value=!0;const t={sort:"createdAt",order:"desc",dateFrom:C.value,dateTo:S.value,dateBoth:$.value};g.value&&(t.teamId=g.value);const l=await Promise.all([N.dispatch("matchesModule/simulator",t),N.dispatch("teamsModule/list",{sort:"name",order:"asc",league:"NBA"})]);E.value=l[0],i.value=[];for(const m of E.value)i.value.push(...m.bets.map(U=>({...U,match:m})));j(),M.value=!1}async function j(){G(),K(w.value),J()}function G(){r.value.wins=0,r.value.losses=0,v.value.wins=0,v.value.losses=0}function J(){c.value.moneyBet[1]=parseFloat(c.value.moneyBet[1]),c.value.moneyNextBet[1]=parseFloat(c.value.moneyNextBet[1]),y.value=w.value.reduce((t,l)=>t+parseFloat(l.money),0),B.value=V(i.value.reduce((t,l)=>((l.type==="U"&&l.value>l.match.scoresDetailed.home+l.match.scoresDetailed.away||l.type==="O"&&l.value<l.match.scoresDetailed.home+l.match.scoresDetailed.away)&&(t+=(l.underQuota||1.63)*parseFloat(l.money)),t),0)),O.value=V((B.value-y.value)/y.value)}function W(t){return t.type==="U"&&t.value>t.match.scoresDetailed.home+t.match.scoresDetailed.away||t.type==="O"&&t.value<t.match.scoresDetailed.home+t.match.scoresDetailed.away}function K(t){t.forEach((l,m)=>{l.type==="U"?l.value>l.match.scoresDetailed.home+l.match.scoresDetailed.away?(r.value.wins++,t[m].win=!0):(r.value.losses++,t[m].win=!1):l.value<l.match.scoresDetailed.home+l.match.scoresDetailed.away?v.value.wins++:v.value.losses++}),r.value.winrate=V(r.value.wins/w.value.length),v.value.winrate=V(v.value.wins/w.value.length),P.value=V((r.value.wins+v.value.wins)/w.value.length)}return(t,l)=>{const m=p("el-option"),U=p("el-select"),T=p("el-date-picker"),A=p("el-divider"),X=p("el-checkbox"),Y=p("el-switch"),Z=p("el-input");return u(),h("div",null,[e("div",de,[e("div",ie,[e("div",re,[d(U,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=a=>g.value=a),placeholder:"Filtrar equipo",onChange:D,clearable:""},{default:H(()=>[(u(!0),h(x,null,F(Q(N).state.teamsModule.teams,(a,f)=>(u(),k(m,{key:f,label:a.name,value:a._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",ce,[l[4]||(l[4]=e("span",{class:""},"Desde",-1)),d(T,{onChange:D,class:"mx-2",modelValue:C.value,"onUpdate:modelValue":l[1]||(l[1]=a=>C.value=a),type:"date",placeholder:"Desde",size:"large"},null,8,["modelValue"])]),e("div",me,[l[5]||(l[5]=e("span",{class:""},"Hasta",-1)),d(T,{onChange:D,class:"mx-2",modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=a=>S.value=a),type:"date",placeholder:"Hasta",size:"large"},null,8,["modelValue"])]),e("div",ve,[l[6]||(l[6]=e("span",{class:""},"Ambos",-1)),d(T,{onChange:D,class:"mx-2",modelValue:$.value,"onUpdate:modelValue":l[3]||(l[3]=a=>$.value=a),type:"date",placeholder:"Ambos",size:"large"},null,8,["modelValue"])])]),d(A),e("div",pe,[(u(!0),h(x,null,F(c.value,(a,f)=>(u(),h("div",{key:f,class:"col-sm-6"},[d(X,{label:a[2],modelValue:a[0],"onUpdate:modelValue":n=>a[0]=n,size:"large"},null,8,["label","modelValue","onUpdate:modelValue"]),e("div",null,[typeof a[1]=="boolean"?(u(),k(Y,{key:0,class:"d-block mb-2",modelValue:a[1],"onUpdate:modelValue":n=>a[1]=n,"active-text":"Sí",disabled:!a[0],"inactive-text":"No"},null,8,["modelValue","onUpdate:modelValue","disabled"])):z("",!0)]),a[3]=="number"?(u(),k(Z,{key:0,type:a[3],disabled:!a[0],modelValue:a[1],"onUpdate:modelValue":n=>a[1]=n},null,8,["type","disabled","modelValue","onUpdate:modelValue"])):z("",!0),a[3]=="text"?(u(),k(U,{key:1,modelValue:a[1],"onUpdate:modelValue":n=>a[1]=n},{default:H(()=>[(u(),h(x,null,F(["c1","c2","c3","c4"],n=>d(m,{key:n,label:n,value:n},null,8,["label","value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):z("",!0)]))),128))]),l[14]||(l[14]=e("div",null,[e("h6")],-1)),d(A),e("div",he,[e("div",fe,[l[12]||(l[12]=e("h4",null,"Resultados simulación",-1)),se(e("h5",ye,"(Calculando)",512),[[te,M.value]]),e("h6",we,"Cantidad de apuestas: "+s(i.value.length),1),e("div",null,[l[7]||(l[7]=e("h6",{class:"d-inline"},"Winrate:",-1)),_(" "+s(((P.value||0)*100).toFixed(2))+"% ("+s(r.value.wins)+"/"+s(i.value.length)+") ",1)]),e("div",null,[l[8]||(l[8]=e("h6",{class:"d-inline"},"Dinero Apostado:",-1)),_(" $ "+s(y.value),1)]),e("div",null,[l[9]||(l[9]=e("h6",{class:"d-inline"},"Dinero Obtenido:",-1)),_(" $ "+s(B.value),1)]),e("div",null,[l[10]||(l[10]=e("h6",{class:"d-inline"},"Ganancia neta:",-1)),_(" $ "+s((B.value-y.value).toFixed(2)),1)]),e("div",null,[l[11]||(l[11]=e("h6",{class:"d-inline"},"Beneficio:",-1)),_(" "+s((O.value*100).toFixed(2))+"% ",1)])])]),d(A),e("table",De,[l[13]||(l[13]=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Fecha"),e("th",{scope:"col"},"Match"),e("th",{scope:"col"},"Total"),e("th",{scope:"col"},"Bet"),e("th",{scope:"col"},"Cuarto"),e("th",{scope:"col"},"Apostado"),e("th",{scope:"col"},"Under Quota"),e("th",{scope:"col"},"Beneficio"),e("th",{scope:"col"},"Over Quota"),e("th",{scope:"col"},"Score"),e("th",{scope:"col"},"Cantidad de montañas"),e("th",{scope:"col"},"Diferencia ups/downs %"),e("th",{scope:"col"},"¿Primera apuesta?")])],-1)),e("tbody",null,[(u(!0),h(x,null,F(i.value,(a,f)=>{var n;return u(),h("tr",{class:oe((n=a.match)!=null&&n.hasOvertime?"table-danger":""),key:f},[e("th",Ve,s(f+1),1),e("td",null,s(Q(ne)(a.match.createdAt)),1),e("td",null,[e("a",{href:`/matches/${a.match._id}`,target:"_blank"},s(`${a.match.teams[0].name} (${a.match.scoresDetailed.home}) - (${a.match.scoresDetailed.away}) ${a.match.teams[1].name}`),9,_e)]),e("td",null,s(a.match.scoresDetailed.home+a.match.scoresDetailed.away),1),e("td",null,s(a.type)+" "+s(a.value)+" "+s(W(a)?"✅":"❌"),1),e("td",null,s(a.quarter)+" "+s(Q(ue)(a.millis)),1),e("td",null,"S/. "+s(a.money),1),e("td",null,s(a.underQuota),1),e("td",null,s(W(a)?`- S/. ${(a.money*(a.underQuota-1)).toFixed(2)}`:`- ${a.money}`),1),e("td",null,s(a.overQuota),1),e("td",null,s(a.scoresDetailed?`${a.scoresDetailed.home} - ${a.scoresDetailed.away}`:"Sin scores"),1),e("td",null,s(a.invertedConesLength),1),e("td",null,s(a.isFirstBet?"Sí":"No"),1),e("td",null,s(a.match.externalId),1)],2)}),128))])])])])}}});export{xe as default};
