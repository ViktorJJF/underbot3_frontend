import{d as R,x as M,f as q,j as F,g as G,r as n,c as K,y as H,h as J,k as m,o as L,a as Q,b as l,t as g,u as d,e as o,p as i,q as w,O as W}from"./index-DHr_EMP0.js";const V=()=>({name:""}),X={class:"row"},Y={class:"col-12"},Z={class:"card box-margin"},ee={class:"card-body"},te={class:"row my-3"},ae={class:"col-sm-12 col-md-5"},le={id:"datatable-buttons_info",class:"dataTables_info",role:"status","aria-live":"polite"},oe={class:"col-sm-12 col-md-7"},se={class:"basic-table-area"},ne={class:"row my-3"},ie={class:"col-sm-12 col-md-5"},ue={id:"datatable-buttons_info",class:"dataTables_info",role:"status","aria-live":"polite"},de={class:"col-sm-12 col-md-7"},re={class:"dialog-footer"},ve=R({__name:"TeamsView",setup(me){const k=M("$formatDate"),$=M("$deepCopy"),a=q();F(),G();const s=n([]),c=n(V()),B=n(V());n({});const r=n(1);n(0);const z=n(["name"]),_=n(""),b=n(!1),x=n(null),v=n(-1),p=n(!1),N=K(()=>v.value===-1?"Crear team":"Editar team");H(_,()=>{clearTimeout(x.value),x.value=setTimeout(()=>{r.value=1,f(r.value)},600)}),J(()=>{f()});async function f(u=1){let e={page:r.value||u,search:_.value,fieldsToSearch:z.value,sort:"createdAt",order:"desc",league:"NBA"};await Promise.all([a.dispatch("teamsModule/list",e)]),s.value=$(a.state.teamsModule.teams)}async function O(){if(b.value=!0,v.value>-1){let u=s.value[v.value]._id;try{await a.dispatch("teamsModule/update",{id:u,data:c.value}),Object.assign(s.value[v.value],c.value),P()}finally{b.value=!1}}else try{let u=await a.dispatch("teamsModule/create",c.value);s.value.push(u),P(),f()}finally{b.value=!1}}function I(u){v.value=s.value.indexOf(u),c.value=Object.assign({},u),p.value=!0}async function j(u){const e=s.value.indexOf(u);let y=s.value[e]._id;await W.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await a.dispatch("teamsModule/delete",y),s.value.splice(e,1))}async function P(){p.value=!1,setTimeout(()=>{c.value=Object.assign({},B.value),v.value=-1},300)}return(u,e)=>{const y=m("el-pagination"),h=m("el-table-column"),T=m("el-input"),C=m("el-button"),U=m("el-table"),A=m("el-form-item"),E=m("el-form"),S=m("el-dialog");return L(),Q("div",X,[l("div",Y,[l("div",Z,[l("div",ee,[l("button",{type:"button",class:"btn btn-primary mb-2 mr-2",onClick:e[0]||(e[0]=t=>{P(),p.value=!0})}," Nuevo "),l("div",te,[l("div",ae,[l("div",le," Mostrando "+g(d(a).state.itemsPerPage>s.value.length?s.value.length:d(a).state.itemsPerPage)+" de "+g(d(a).state.teamsModule.total)+" registros ",1)]),l("div",oe,[o(y,{"current-page":r.value,"onUpdate:currentPage":e[1]||(e[1]=t=>r.value=t),background:"",layout:"pager",total:d(a).state.teamsModule.total,"page-size":d(a).state.itemsPerPage,onCurrentChange:e[2]||(e[2]=t=>f(r.value))},null,8,["current-page","total","page-size"])])]),l("div",se,[o(U,{border:"",stripe:"",data:s.value,style:{width:"100%"}},{default:i(()=>[o(h,{label:"Fecha creación",prop:"createdAt"},{default:i(t=>[l("span",null,g(d(k)(t.row.createdAt)),1)]),_:1}),o(h,{label:"Nombre",prop:"name"}),o(h,{align:"right"},{header:i(()=>[o(T,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:i(t=>[o(C,{size:"small",type:"primary",onClick:D=>I(t.row)},{default:i(()=>e[9]||(e[9]=[w(" Editar ")])),_:2},1032,["onClick"]),o(C,{size:"small",type:"danger",onClick:D=>j(t.row)},{default:i(()=>e[10]||(e[10]=[w(" Borrar ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l("div",ne,[l("div",ie,[l("div",ue," Mostrando "+g(d(a).state.itemsPerPage>s.value.length?s.value.length:d(a).state.itemsPerPage)+" de "+g(d(a).state.teamsModule.total)+" registros ",1)]),l("div",de,[o(y,{"current-page":r.value,"onUpdate:currentPage":e[4]||(e[4]=t=>r.value=t),background:"",layout:"pager",total:d(a).state.teamsModule.total,"page-size":d(a).state.itemsPerPage,onCurrentChange:e[5]||(e[5]=t=>f(r.value))},null,8,["current-page","total","page-size"])])])])])]),o(S,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=t=>p.value=t),title:N.value,width:"30%"},{footer:i(()=>[l("span",re,[o(C,{onClick:e[7]||(e[7]=t=>p.value=!1)},{default:i(()=>e[11]||(e[11]=[w("Cancelar")])),_:1}),o(C,{type:"success",loading:b.value,onClick:O},{default:i(()=>e[12]||(e[12]=[w(" Guardar ")])),_:1},8,["loading"])])]),default:i(()=>[o(E,{"label-position":"top","label-width":"100px"},{default:i(()=>[o(A,{label:"Nombre"},{default:i(()=>[o(T,{modelValue:c.value.name,"onUpdate:modelValue":e[6]||(e[6]=t=>c.value.name=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}});export{ve as default};
