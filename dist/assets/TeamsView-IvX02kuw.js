import{d as R,y as M,f as q,j as F,g as G,r as n,c as K,z as H,h as J,k as c,o as L,a as Q,e as l,t as f,u as d,b as o,n as i,p as C,P as W}from"./index-TNlp-m_q.js";const V=()=>({name:""}),X={class:"row"},Y={class:"col-12"},Z={class:"card box-margin"},ee={class:"card-body"},te={class:"row my-3"},ae={class:"col-sm-12 col-md-5"},le={id:"datatable-buttons_info",class:"dataTables_info",role:"status","aria-live":"polite"},oe={class:"col-sm-12 col-md-7"},se={class:"basic-table-area"},ne={class:"row my-3"},ie={class:"col-sm-12 col-md-5"},ue={id:"datatable-buttons_info",class:"dataTables_info",role:"status","aria-live":"polite"},de={class:"col-sm-12 col-md-7"},re={class:"dialog-footer"},ve=R({__name:"TeamsView",setup(ce){const k=M("$formatDate"),$=M("$deepCopy"),a=q();F(),G();const s=n([]),m=n(V()),B=n(V());n({});const r=n(1);n(0);const z=n(["name"]),g=n(""),b=n(!1),T=n(null),v=n(-1),p=n(!1),N=K(()=>v.value===-1?"Crear team":"Editar team");H(g,()=>{clearTimeout(T.value),T.value=setTimeout(()=>{r.value=1,_(r.value)},600)}),J(()=>{_()});async function _(u=1){let e={page:r.value||u,search:g.value,fieldsToSearch:z.value,sort:"createdAt",order:"desc",league:"NBA"};await Promise.all([a.dispatch("teamsModule/list",e)]),s.value=$(a.state.teamsModule.teams)}async function I(){if(b.value=!0,v.value>-1){let u=s.value[v.value]._id;try{await a.dispatch("teamsModule/update",{id:u,data:m.value}),Object.assign(s.value[v.value],m.value),w()}finally{b.value=!1}}else try{let u=await a.dispatch("teamsModule/create",m.value);s.value.push(u),w(),_()}finally{b.value=!1}}function O(u){v.value=s.value.indexOf(u),m.value=Object.assign({},u),p.value=!0}async function j(u){const e=s.value.indexOf(u);let y=s.value[e]._id;await W.confirm("¿Realmente deseas eliminar este registro?","Confirmación",{confirmButtonText:"OK",cancelButtonText:"Cancelar",type:"warning"})&&(await a.dispatch("teamsModule/delete",y),s.value.splice(e,1))}async function w(){p.value=!1,setTimeout(()=>{m.value=Object.assign({},B.value),v.value=-1},300)}return(u,e)=>{const y=c("el-pagination"),P=c("el-table-column"),x=c("el-input"),h=c("el-button"),U=c("el-table"),A=c("el-form-item"),E=c("el-form"),S=c("el-dialog");return L(),Q("div",X,[l("div",Y,[l("div",Z,[l("div",ee,[l("button",{type:"button",class:"btn btn-primary mb-2 mr-2",onClick:e[0]||(e[0]=t=>{w(),p.value=!0})}," Nuevo "),l("div",te,[l("div",ae,[l("div",le," Mostrando "+f(d(a).state.itemsPerPage>s.value.length?s.value.length:d(a).state.itemsPerPage)+" de "+f(d(a).state.teamsModule.total)+" registros ",1)]),l("div",oe,[o(y,{"current-page":r.value,"onUpdate:currentPage":e[1]||(e[1]=t=>r.value=t),background:"",layout:"pager",total:d(a).state.teamsModule.total,"page-size":d(a).state.itemsPerPage,onCurrentChange:e[2]||(e[2]=t=>_(r.value))},null,8,["current-page","total","page-size"])])]),l("div",se,[o(U,{border:"",stripe:"",data:s.value,style:{width:"100%"}},{default:i(()=>[o(P,{label:"Fecha creación",prop:"createdAt"},{default:i(t=>[l("span",null,f(d(k)(t.row.createdAt)),1)]),_:1}),o(P,{label:"Nombre",prop:"name"}),o(P,{align:"right"},{header:i(()=>[o(x,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=t=>g.value=t),placeholder:"Búsquedas...",clearable:""},null,8,["modelValue"])]),default:i(t=>[o(h,{size:"small",type:"primary",onClick:D=>O(t.row)},{default:i(()=>[C(" Editar ")]),_:2},1032,["onClick"]),o(h,{size:"small",type:"danger",onClick:D=>j(t.row)},{default:i(()=>[C(" Borrar ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l("div",ne,[l("div",ie,[l("div",ue," Mostrando "+f(d(a).state.itemsPerPage>s.value.length?s.value.length:d(a).state.itemsPerPage)+" de "+f(d(a).state.teamsModule.total)+" registros ",1)]),l("div",de,[o(y,{"current-page":r.value,"onUpdate:currentPage":e[4]||(e[4]=t=>r.value=t),background:"",layout:"pager",total:d(a).state.teamsModule.total,"page-size":d(a).state.itemsPerPage,onCurrentChange:e[5]||(e[5]=t=>_(r.value))},null,8,["current-page","total","page-size"])])])])])]),o(S,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=t=>p.value=t),title:N.value,width:"30%"},{footer:i(()=>[l("span",re,[o(h,{onClick:e[7]||(e[7]=t=>p.value=!1)},{default:i(()=>[C("Cancelar")]),_:1}),o(h,{type:"success",loading:b.value,onClick:I},{default:i(()=>[C(" Guardar ")]),_:1},8,["loading"])])]),default:i(()=>[o(E,{"label-position":"top","label-width":"100px"},{default:i(()=>[o(A,{label:"Nombre"},{default:i(()=>[o(x,{modelValue:m.value.name,"onUpdate:modelValue":e[6]||(e[6]=t=>m.value.name=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}});export{ve as default};
